<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Cadastro</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">
  <div class="container mt-5">
    <h2>Cadastrar Usuário</h2>

    <!-- Aviso irreversível -->
    <div class="alert alert-warning">
      <strong>Atenção:</strong> O cadastro é uma operação <strong>irreversível</strong>. Verifique as informações antes de continuar.
    </div>

  <!-- Explicação da senha forte -->
<div class="alert alert-info">
  <strong>Importante:</strong> Sua senha precisa ser <strong>forte</strong> e conter:
  <ul>
    <li>Pelo menos <strong>6 caracteres</strong></li>
    <li><strong>Letras maiúsculas</strong> (A‑Z)</li>
    <li><strong>Letras minúsculas</strong> (a‑z)</li>
    <li><strong>Números</strong> (0‑9)</li>
    <li><strong>Caracteres especiais</strong> (ex: !, @, #, $, %...)</li>
  </ul>
</div>


    <!-- Mensagens do servidor -->
    <% if (success_msg) { %>
      <div class="alert alert-success"><%= success_msg %></div>
    <% } %>
    <% if (error_msg) { %>
      <div class="alert alert-danger"><%= error_msg %></div>
    <% } %>
    <% erros.forEach(erro => { %>
      <div class="alert alert-warning"><%= erro.msg %></div>
    <% }) %>

    <!-- Formulário -->
    <form method="POST" action="/register">
      <input type="hidden" name="_csrf" value="<%= csrfToken %>">
      <div class="mb-3">
        <label for="email">E‑mail</label>
        <input
          type="email"
          class="form-control"
          id="email"
          name="email"
          value="<%= email %>"
          required
        >
      </div>

      <div class="mb-3">
        <label for="senha">Senha</label>
        <input
          type="password"
          class="form-control"
          id="senha"
          name="senha"
          required
          minlength="6"
        >
      </div>

      <div class="mb-3">
        <label for="senha2">Confirmar Senha</label>
        <input
          type="password"
          class="form-control"
          id="senha2"
          name="senha2"
          required
          minlength="6"
        >
      </div>

      <div class="mb-3">
        <label for="role">Tipo de usuário</label>
        <select class="form-select" id="role" name="role" required>
          <option value="" disabled <%= !role ? 'selected' : '' %>>Selecione o tipo</option>
          <option value="user" <%= role === 'user' ? 'selected' : '' %>>Usuário</option>
          <option value="admin" <%= role === 'admin' ? 'selected' : '' %>>Administrador</option>
        </select>
      </div>

      <button type="submit" class="btn btn-primary">Cadastrar</button>
    </form>
  </div>
</body>
</html>
